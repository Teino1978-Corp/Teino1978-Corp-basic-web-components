<!--

Base class for some of the elements in the Basic Web Components collection.

This provides some services which aren't provided by the browser or Polymer.
Right now, this includes:

* Generic styling. A "generic" attribute, which defaults to true, allows
  elements to receive baseline styling that can easily be removed by setting
  "generic" to false.

* contentChanged. A callback invoked when an element's light DOM content changes.
  This is also invoked if the element contains a <content> node and new nodes
  are distributed to that. Note: if an element has an attached callback, the
  callback should invoke this.super() for contentChanged to work.

* Content flattening. General-purpose composable elements need to be able to
  walk their content tree, including distributed content. This class defines
  helpers called flattenChildren, flattenChildNodes, flattenTextContent that
  parallel the standard children, childNodes, and textContent properties,
  respectively, expanding any content nodes to include distributed content.

@element basic-element
-->

<link rel="import" href="../polymer/polymer.html">
<script src="../basic-helpers/BasicContentHelpers.js"></script>

<dom-module id="basic=element"></dom-module>
<script>

var BasicElement = {

  BasicElement_attached: function() {
    this.observeContentChanges();
  },

  BasicElement_detached: function() {
    this.observeContentChanges(false);
  },

  // Log output to the console prefixed by the element's tag. This makes it
  // easier to see which element is logging the output.
  BasicElement_log: function(s) {
    if (console) {
      console.log(this.localName + ': ' + s);
    }
  },

  BasicElement_ready: function() {
    this.BasicElement_setup();
  },

  // Non-functions are referenced by clients as MixinName.property
  generic: {
    type: Boolean,
    value: null,
    reflectToAttribute: true
  },

  BasicElement_setup: function() {
    // We explicitly set the generic attribute to true, rather than providing
    // that as a default value. A default value won't appear on an element
    // instance as an attribute, but an attribute we set explicitly will. We
    // need the attribute there so that generic styling can be set simply by
    // defining rules like
    //
    //   :host([generic=""]) {
    //     ...
    //   }
    //
    if (this.getAttribute('generic') == null) {
      this.generic = true;
    }
  }

};

/*
 * Basic element base class.
 */
Polymer({

  is: 'basic-element',

  attached: function() {
    this.BasicElement_attached();
  },

  detached: function() {
    this.BasicElement_detached();
  },

  ready: function() {
    this.BasicElement_ready();
  },

  properties: {
    generic: BasicElement.generic
  },

  mixins: [BasicContentHelpers, BasicElement]

});
</script>
