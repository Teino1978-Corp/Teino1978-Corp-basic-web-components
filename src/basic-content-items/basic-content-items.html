<!--
Aspect for treating DOM content as list items.
-->

<link rel="import" href="../basic-aspect/basic-aspect.html">

<script>
Polymer(mixin(BasicAspectMixin, {

  contribute: {

    applySelection: function(item, selected) {
      item.classList.toggle('selected', selected);
    },

    contentChanged: function() {
      if (this.itemsChanged) {
        this.itemsChanged();
      }
    },

    /*
     * Return the index of the indicated item.
     */
    indexOfItem: function(item) {
      return this.items.indexOf(item);
    },

    itemsChanged: function() {
      // Perform per-item initialization.
      this.items.forEach(function(item) {
        if (!item._itemInitialized) {
          this.itemAdded(item);
          item._itemInitialized = true;
        }
      }.bind(this));

      var event = new CustomEvent('items-changed', {
        bubbles: true
      });
      this.dispatchEvent(event);
    },

    get items() {
      // TODO: Memoize
      // TODO: Filter out auxiliary content.
      // TODO: property notifications so elements can bind to this property
      return this.content;
    }

  },

  is: 'basic-content-items',

  // Default implementations do nothing. These will usually be overwritten by
  // collective methods.
  itemAdded: function() {},
  itemsChanged: function() {}

}));
</script>
